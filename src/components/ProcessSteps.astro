---
import { siteConfig } from "../data/site";

const { process } = siteConfig;
---

<section class="py-16 bg-gray-950">
  <div class="container mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-12">
      <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">
        Mūsų Procesas
      </h2>
      <p class="text-xl text-gray-400 max-w-2xl mx-auto">
        Šeši kruopštūs žingsniai tobulai apdailai
      </p>
    </div>

    <div class="max-w-5xl mx-auto">
      <div class="space-y-8">
        {
          process.map((step, index) => (
            <article
              class="relative flex flex-col md:flex-row gap-6 items-start process-step"
              data-step-index={index}
            >
              {/* Connector Line (not on last item) */}
              {index < process.length - 1 && (
                <div
                  class="absolute left-8 top-8 w-0.5 h-[calc(100%+2rem)] bg-gradient-to-b from-cyan-500 to-transparent z-0 pointer-events-none"
                  aria-hidden="true"
                />
              )}

              {/* Step Number */}
              <div class="relative z-10 flex-shrink-0 step-number opacity-0 scale-0">
                <div class="w-16 h-16 rounded-full bg-gradient-to-br from-cyan-500 to-cyan-700 flex items-center justify-center shadow-lg shadow-cyan-500/30">
                  <span class="text-2xl font-bold text-white">{step.step}</span>
                </div>
              </div>

              {/* Content */}
              <div class="relative z-10 flex-1 bg-gray-900 rounded-lg p-6 border border-gray-800 hover:border-cyan-500/50 transition-colors step-content opacity-0 translate-x-[50px]">
                <h3 class="text-xl font-bold text-white mb-2">{step.title}</h3>
                <p class="text-gray-400 leading-relaxed">{step.description}</p>
              </div>
            </article>
          ))
        }
      </div>
    </div>

    <div class="text-center mt-12">
      <p class="text-gray-500 mb-6">Pasiruošę pradėti savo projektą?</p>
      <a
        href="/contact"
        class="inline-flex items-center px-8 py-3 bg-cyan-500 text-white font-semibold rounded-lg hover:bg-cyan-600 transition-colors shadow-lg shadow-cyan-500/30"
      >
        Pradėkite Šiandien
        <svg
          class="ml-2 w-5 h-5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M9 5l7 7-7 7"></path>
        </svg>
      </a>
    </div>
  </div>
</section>

<style>
  .process-step .step-number,
  .process-step .step-content {
    will-change: transform, opacity;
  }

  @media (prefers-reduced-motion: reduce) {
    .process-step .step-number,
    .process-step .step-content {
      opacity: 1 !important;
      transform: none !important;
    }
  }
</style>

<script>
  import { inView, animate } from "motion";

  const steps = Array.from(document.querySelectorAll(".process-step"));

  steps.forEach((step) => {
    const bubble = step.querySelector(".step-number");
    const content = step.querySelector(".step-content");

    inView(
      step,
      () => {
        if (bubble) bubble.classList.remove("opacity-0", "scale-0");
        if (content)
          content.classList.remove("opacity-0", "translate-x-[50px]");

        if (bubble) {
          animate(
            bubble,
            { opacity: [0, 1], scale: [0, 1] },
            { duration: 0.45, ease: [0.22, 1, 0.36, 1] },
          );
        }

        if (content) {
          animate(
            content,
            { opacity: [0, 1], x: [50, 0] },
            { duration: 0.6, ease: [0.22, 1, 0.36, 1], delay: 0.08 },
          );
        }
      },
      { amount: "all" },
    );
  });
</script>
