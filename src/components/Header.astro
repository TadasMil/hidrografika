---
import { siteConfig } from "../data/site";

const base = import.meta.env.BASE_URL;
const navItems = [
  { href: `${base}`, label: "Pradžia" },
  { href: `${base}services/`, label: "Paslaugos" },
  { href: `${base}gallery/`, label: "Galerija" },
  { href: `${base}pricing/`, label: "Kainos" },
  { href: `${base}about/`, label: "Apie Mus" },
  { href: `${base}faq/`, label: "DUK" },
  { href: `${base}contact/`, label: "Kontaktai" },
];

const currentPath = Astro.url.pathname;
---

<header
  class="bg-gray-900 border-b border-gray-800 sticky top-0 z-50 backdrop-blur-md bg-opacity-95"
>
  <nav
    class="container mx-auto px-4 sm:px-6 lg:px-8"
    aria-label="Pagrindinis navigacijas"
  >
    <div class="flex items-center justify-between h-24">
      <!-- Logo -->
      <div class="shrink-0">
        <a href={base} class="hover:opacity-80 transition-opacity">
          <img
            src={`${base}logo.png`}
            alt={siteConfig.brandName}
            class="h-28 md:h-32 w-auto"
            width="256"
            height="256"
          />
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center space-x-1">
        {
          navItems.map((item) => (
            <a
              href={item.href}
              class={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                currentPath === item.href
                  ? "text-cyan-400 bg-gray-800"
                  : "text-gray-300 hover:text-white hover:bg-gray-800"
              }`}
            >
              {item.label}
            </a>
          ))
        }
      </div>

      <!-- CTA Button - Desktop -->
      <div class="hidden lg:block">
        <a
          href={`${base}contact/`}
          class="inline-flex items-center px-6 py-2.5 bg-cyan-500 text-white font-semibold rounded-md hover:bg-cyan-600 transition-colors shadow-lg shadow-cyan-500/30"
        >
          Gauti Pasiūlymą
        </a>
      </div>

      <!-- Mobile Menu Button -->
      <button
        id="mobile-menu-button"
        type="button"
        class="lg:hidden inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-white hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-cyan-500"
        aria-expanded="false"
        aria-controls="mobile-menu"
        aria-label="Perjungti navigacijos meniu"
      >
        <!-- Hamburger Icon -->
        <svg
          id="hamburger-icon"
          class="block h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5"></path>
        </svg>
        <!-- Close Icon -->
        <svg
          id="close-icon"
          class="hidden h-6 w-6"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
          aria-hidden="true"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </div>

    <!-- Mobile Navigation Menu -->
    <div id="mobile-menu" class="hidden lg:hidden">
      <div
        class="px-2 pt-2 pb-3 space-y-1 bg-gray-900 border-t border-gray-800"
      >
        {
          navItems.map((item) => (
            <a
              href={item.href}
              class={`block px-3 py-2 rounded-md text-base font-medium transition-colors ${
                currentPath === item.href
                  ? "text-cyan-400 bg-gray-800"
                  : "text-gray-300 hover:text-white hover:bg-gray-800"
              }`}
            >
              {item.label}
            </a>
          ))
        }
        <a
          href={`${base}contact/`}
          class="block text-center mt-4 mx-3 px-6 py-2.5 bg-cyan-500 text-white font-semibold rounded-md hover:bg-cyan-600 transition-colors shadow-lg shadow-cyan-500/30"
        >
          Gauti Pasiūlymą
        </a>
      </div>
    </div>
  </nav>
</header>

<script>
  // Mobile menu toggle functionality
  function initMobileMenu() {
    const button = document.getElementById("mobile-menu-button");
    const menu = document.getElementById("mobile-menu");
    const hamburgerIcon = document.getElementById("hamburger-icon");
    const closeIcon = document.getElementById("close-icon");

    if (button && menu && hamburgerIcon && closeIcon) {
      button.addEventListener("click", () => {
        const isExpanded = button.getAttribute("aria-expanded") === "true";
        const newExpanded = !isExpanded;

        // Update button state
        button.setAttribute("aria-expanded", String(newExpanded));

        // Toggle menu visibility
        menu.classList.toggle("hidden");

        // Toggle icons
        hamburgerIcon.classList.toggle("hidden");
        closeIcon.classList.toggle("hidden");
      });

      // Close menu when clicking on a navigation link
      const navLinks = menu.querySelectorAll("a");
      navLinks.forEach((link) => {
        link.addEventListener("click", () => {
          button.setAttribute("aria-expanded", "false");
          menu.classList.add("hidden");
          hamburgerIcon.classList.remove("hidden");
          closeIcon.classList.add("hidden");
        });
      });
    }
  }

  // Initialize on page load
  document.addEventListener("DOMContentLoaded", initMobileMenu);

  // Re-initialize after Astro page transitions
  document.addEventListener("astro:page-load", initMobileMenu);
</script>
